<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#000000" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/creativetimofficial/tailwind-starter-kit/compiled-tailwind.min.css" />
  <title>Text Sentiment Prediction</title>
  <style>
    .fade-in {
      animation: fadeIn 0.8s ease-in-out;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .spinner {
      border: 4px solid rgba(0, 0, 0, 0.1);
      width: 36px;
      height: 36px;
      border-radius: 50%;
      border-left-color: #09f;
      animation: spin 1s ease infinite;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }
  </style>
</head>

<body class="text-gray-800 antialiased">
  <script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.js" defer></script>

  <main>
    <!-- Hero Section -->
    <div class="relative pt-10 pb-20 flex content-center items-center justify-center min-h-[50vh]">
      <div class="absolute top-0 w-full h-full bg-gradient-to-r from-green-300 to-blue-500">
        <span id="blackOverlay" class="w-full h-full absolute opacity-40 bg-black"></span>
      </div>
      <div class="container relative mx-auto px-4">
        <div class="text-center">
          <h1 class="text-white font-bold text-4xl sm:text-5xl">
            Analyze Emotions in Text Instantly 🎯
          </h1>
          <p class="mt-4 text-lg text-gray-100 max-w-xl mx-auto">
            Discover if your message is Positive 😊, Negative 😡 or Neutral 😐 using smart AI-powered sentiment detection.
          </p>
        </div>
      </div>
    </div>

    <!-- Input Section -->
    <section class="relative py-16">
      <div class="flex flex-col items-center justify-center">
        <h1 class="text-4xl font-semibold py-4">Sentiment Prediction Tool</h1>
      </div>
      <div class="container mx-auto px-4">
        <div class="flex flex-wrap justify-center">
          <!-- Input Panel -->
          <div class="w-full md:w-5/12 px-4">
            <form id="predictionForm">
              <div class="max-w-md mx-auto">
                <div class="mb-4">
                  <label class="block text-gray-600 text-sm mb-2">Upload CSV File</label>
                  <input type="file" id="csvFileInput" accept=".csv" class="w-full px-3 py-2 border rounded-lg shadow-md focus:outline-none">
                </div>
                <div class="mb-4">
                  <label class="block text-gray-600 text-sm mb-2">Text for Prediction</label>
                  <textarea id="textInput" rows="4" placeholder="Enter your text here..." class="w-full px-3 py-2 border rounded-lg shadow-md focus:outline-none"></textarea>
                </div>
                <button type="button" onclick="predict()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-3 rounded-lg shadow-md">
                  Predict
                </button>
                <div id="loadingSpinner" class="flex justify-center mt-4 hidden">
                  <div class="spinner"></div>
                </div>
              </div>
            </form>
          </div>

          <!-- Result Panel -->
          <div class="w-full md:w-5/12 px-4 mt-8 md:mt-0">
            <div>
              <h2 class="text-3xl font-semibold underline mb-2">Prediction Result</h2>
              <div class="p-4 border rounded-lg min-h-[60px]" id="predictionResult"></div>
              <button id="downloadBtn" style="display:none"
                class="mt-6 w-full text-lg font-semibold bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg shadow-md">
                Download Predictions
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="bg-gray-900 py-6">
    <div class="container mx-auto text-center text-white text-sm">
      © 2025 Text Sentiment Predictor. Built with 💙 for your insights.
    </div>
  </footer>

  <!-- JavaScript -->
  <script>
    function getEmoji(prediction) {
      const map = {
        "positive": "😊",
        "negative": "😡",
        "neutral": "😐"
      };
      return map[prediction.toLowerCase()] || "";
    }

    function predict() {
      const csvFileInput = document.getElementById("csvFileInput");
      const textInput = document.getElementById("textInput");
      const predictionResult = document.getElementById("predictionResult");
      const loadingSpinner = document.getElementById("loadingSpinner");

      predictionResult.innerHTML = "";
      predictionResult.classList.remove("fade-in");
      loadingSpinner.classList.remove("hidden");

      if (csvFileInput.files.length > 0) {
        const formData = new FormData();
        formData.append("file", csvFileInput.files[0]);

        fetch("http://localhost:5000/predict", {
          method: "POST",
          body: formData
        })
        .then(response => response.blob())
        .then(blob => {
          document.getElementById("downloadBtn").style.display = "block";
          document.getElementById("downloadBtn").onclick = function () {
            const url = URL.createObjectURL(blob);
            const a = document.createElement("a");
            a.href = url;
            a.download = "Predictions.csv";
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
          };
        })
        .catch(error => console.error("CSV Prediction Error:", error))
        .finally(() => loadingSpinner.classList.add("hidden"));
      } else if (textInput.value.trim() !== "") {
        fetch("http://localhost:5000/predict", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({ "text": textInput.value.trim() })
        })
        .then(response => response.json())
        .then(data => {
          const emoji = getEmoji(data.prediction);
          predictionResult.innerHTML = `<strong>Prediction:</strong> ${data.prediction} ${emoji}`;
          predictionResult.classList.add("fade-in");
        })
        .catch(error => console.error("Text Prediction Error:", error))
        .finally(() => loadingSpinner.classList.add("hidden"));
      } else {
        loadingSpinner.classList.add("hidden");
        predictionResult.innerHTML = `<span class="text-red-600">Please upload a file or enter some text.</span>`;
      }
    }
  </script>
</body>

</html>
